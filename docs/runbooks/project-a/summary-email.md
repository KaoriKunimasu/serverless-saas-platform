# Runbook: Project A Summary Email (dev)

## Purpose
Send a periodic summary email generated by the Summary Lambda function.

---

## Trigger
- EventBridge rule:
  - `project-a-summary-every5min-dev` (dev)
  - `project-a-summary-daily-prod` (prod)

---

## Lambda
- Function name:
  - `CdkStack-SummaryFn*`

---

## Logs
- CloudWatch Log Group:
  - `/aws/lambda/CdkStack-SummaryFn*`

Key log messages:
- `summary.debug.event`
- `summary.generated`
- `summary.email.sent`
- `summary.email.skipped`

---

## If email doesn't arrive

1. Check CloudWatch Logs  
   Confirm that `summary.email.sent` appears in the logs.

2. Check environment variables  
   Ensure the following variables are set on the Lambda function:
   - `SUMMARY_FROM_EMAIL`
   - `SUMMARY_TO_EMAIL`

3. Check SES status  
   - Sender email is verified
   - Recipient email is verified (SES sandbox)
   - Region matches Lambda region

4. Check IAM permissions  
   Lambda execution role must allow:
   - `ses:SendEmail`
   - `ses:SendRawEmail`

5. Check invocation source  
   Verify that the EventBridge rule is enabled and invoking the Lambda.

---

## Manual test
Invoke the Lambda directly:

```bash
aws lambda invoke \
  --function-name <SummaryFnName> \
  --payload fileb://payload.json \
  out.json
